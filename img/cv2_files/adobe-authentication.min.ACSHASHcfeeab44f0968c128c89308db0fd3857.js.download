(function(g){ns("News.App.Adobe").Authentication={adobeEndPoint:"https://sp.auth.adobe.com",usrAuth:"",hhid:"",hbaStatus:"",mvpd:"",requestID:g("body").data("requestid"),client_id:localStorage.getItem("client_id"),client_secret:localStorage.getItem("client_secret"),access_token:localStorage.getItem("access_token"),adobe_token_expiry:localStorage.getItem("token_expiry"),deviceId:localStorage.getItem("deviceId"),refreshAdobeToken:function(){News.App.Adobe.Authentication.client_id&&News.App.Adobe.Authentication.client_secret||
News.App.Adobe.Authentication.dcr();News.App.Adobe.Authentication.access_token||News.App.Adobe.Authentication.getDeviceToken();new Date>=new Date(Number(News.App.Adobe.Authentication.adobe_token_expiry))&&News.App.Adobe.Authentication.getDeviceToken()},dcr:function(){var a=News.App.Adobe.Authentication.adobeEndPoint+"/o/client/register",b=(new Date).getTime(),e={software_statement:g("body").data("softwarestatement")},c={model:navigator.platform,osName:News.App.Pinxt.Authentication.getOS(),userAgent:navigator.userAgent};
localStorage.setItem("deviceInfo",btoa(JSON.stringify(c)));g.ajax({type:"POST",url:a,contentType:"application/json",async:!1,headers:{"Content-Type":"application/json",Accept:"application/json","X-Device-Info":btoa(JSON.stringify(c))},data:JSON.stringify(e),success:function(d){localStorage.setItem("client_id",d.client_id);localStorage.setItem("client_secret",d.client_secret);News.App.QuantumAnalytics.quantumApiSuccessOrFailure(a,200,"All_Generic_API_Call_Success",b,"POST","N/A")},error:function(d){News.App.QuantumAnalytics.quantumApiSuccessOrFailure(a,
d.status,"All_Generic_API_Call_Failure",b,"GET","N/A")}})},getDeviceToken:function(){var a=localStorage.getItem("client_id"),b=localStorage.getItem("client_secret"),e=localStorage.getItem("deviceInfo"),c=News.App.Adobe.Authentication.adobeEndPoint+"/o/client/token",d=(new Date).getTime();g.ajax({type:"POST",url:c,contentType:"application/json",async:!1,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":btoa(JSON.stringify(e))},data:{grant_type:"client_credentials",
client_id:a,client_secret:b},success:function(f){localStorage.setItem("tokenDetails",JSON.stringify(f));localStorage.setItem("access_token",f.access_token);var h=new Date;f=h.setSeconds(h.getSeconds()+f.expires_in);localStorage.setItem("token_expiry",f.toString());News.App.Adobe.Authentication.adobe_token_expiry=f.toString();News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,200,"All_Generic_API_Call_Success",d,"POST","N/A")},error:function(f){News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,
f.status,"All_Generic_API_Call_Failure",d,"POST","N/A")}})},getAuthN:function(){var a=News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/tokens/authn",b=(new Date).getTime(),e={requestor:News.App.Adobe.Authentication.requestID,deviceId:localStorage.getItem("deviceId")};g.ajax({type:"GET",url:a,contentType:"application/json",async:!1,headers:{Authorization:"Bearer"+localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},
data:e,success:function(c){var d=c.mvpd;d&&d.startsWith("TempPass")&&News.App.Adobe.Authentication.setTokenExpiryDate(Number(c.expires));News.App.Pinxt.Authentication.setAuthenticationStatus(!0);News.App.QuantumAnalytics.quantumApiSuccessOrFailure(a,200,"All_Generic_API_Call_Success",b,"GET",JSON.stringify(e))},error:function(c){News.App.QuantumAnalytics.quantumApiSuccessOrFailure(a,c.status,"All_Generic_API_Call_Failure",b,"GET",JSON.stringify(e));if(404===c.status)return News.App.Pinxt.Authentication.setAuthenticationStatus(!1),
null;410===c.status&&News.App.Pinxt.Authentication.goToPage("unauthorized")}})},checkAuthN:function(){g.ajax({type:"GET",url:News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/checkauthn",contentType:"application/json",headers:{Authorization:"Bearer"+localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},data:{requestor:News.App.Adobe.Authentication.requestID,deviceId:localStorage.getItem("deviceId")},
success:function(a){},error:function(){}})},getShortMediaToken:function(a){var b=g.Deferred(),e=(new Date).getTime(),c=News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/tokens/media",d={requestor:News.App.Adobe.Authentication.requestID,deviceId:localStorage.getItem("deviceId"),resource:a};g.ajax({type:"GET",url:c,contentType:"application/json",headers:{Authorization:"Bearer"+localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},
data:d,success:function(f){b.resolve(f);News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,200,"All_Generic_API_Call_Success",e,"GET",JSON.stringify(d))},error:function(f,h){b.reject(f);News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,f.status,"All_Generic_API_Call_Failure",e,"GET",JSON.stringify(d))}});return b.promise()},getUserMetaData:function(){var a={},b=News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/tokens/usermetadata",e=(new Date).getTime(),c={requestor:News.App.Adobe.Authentication.requestID,
deviceId:localStorage.getItem("deviceId")};g.ajax({type:"GET",url:b,contentType:"application/json",async:!1,headers:{Authorization:"Bearer"+localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},data:c,success:function(d){News.App.Adobe.Authentication.hhid=d.data.householdID;News.App.Adobe.Authentication.hbaStatus=d.data.hba_status;a=d.data;News.App.Adobe.Authentication.setMetadataStatus(d.data);
News.App.QuantumAnalytics.quantumApiSuccessOrFailure(b,200,"All_Generic_API_Call_Success",e,"GET",JSON.stringify(c))},error:function(d){News.App.QuantumAnalytics.quantumApiSuccessOrFailure(b,d.status,"All_Generic_API_Call_Failure",e,"GET",JSON.stringify(c))}});return a},getAuthZ:function(a){var b,e=(new Date).getTime(),c=News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/authorize",d={requestor:News.App.Adobe.Authentication.requestID,deviceId:localStorage.getItem("deviceId"),resource:a};g.ajax({type:"GET",
url:c,contentType:"application/json",async:!1,headers:{Authorization:"Bearer"+localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},data:d,success:function(f){b=!0;News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,200,"All_Generic_API_Call_Success",e,"GET",JSON.stringify(d))},error:function(f){b=!1;News.App.Adobe.Authentication.usrAuth&&403==f.status&&News.App.Pinxt.Authentication.goToPage("unauthorized");
News.App.QuantumAnalytics.quantumApiSuccessOrFailure(c,f.status,"All_Generic_API_Call_Failure",e,"GET",JSON.stringify(d))}});return b},logout:function(){var a=window.location.href,b=News.App.Adobe.Authentication.adobeEndPoint+"/api/v1/logout?",e=Cookies.get("player-mvpd"),c=g.param({requestor:News.App.Adobe.Authentication.requestID,deviceId:localStorage.getItem("deviceId")}),d=(new Date).getTime();g.ajax({type:"DELETE",url:b+c,contentType:"application/json",async:!1,headers:{Authorization:"Bearer"+
localStorage.getItem("access_token"),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Device-Info":localStorage.getItem("deviceInfo")},success:function(){Cookies.remove("authenticated");Cookies.remove("player-hhid");Cookies.remove("player-mvpd");localStorage.removeItem("authenticated");localStorage.removeItem("player-hhid");localStorage.removeItem("player-mvpd");localStorage.removeItem("hba-status");localStorage.removeItem("access_token");localStorage.removeItem("regCode");
localStorage.removeItem("deviceInfo");localStorage.removeItem("deviceId");localStorage.removeItem("client_id");localStorage.removeItem("client_secret");localStorage.removeItem("token_expiry");e&&!e.startsWith("TempPass")&&News.App.Pinxt.Authentication.piNxtLogout();"undefined"!==typeof Cookies.get("LIVETVLOGIN-CLICKED")&&Cookies.get("LIVETVLOGIN-CLICKED")&&Cookies.remove("LIVETVLOGIN-CLICKED");News.App.QuantumAnalytics.quantumApiSuccessOrFailure(b,200,"All_Generic_API_Call_Success",d,"GET",c);window.location.href=
a},error:function(f){News.App.QuantumAnalytics.quantumApiSuccessOrFailure(b,f.status,"All_Generic_API_Call_Failure",d,"GET",c)}})},handleTempPass:function(){var a=Cookies.get("player-mvpd");a&&a.startsWith("TempPass")&&setInterval(function(){"1"===Cookies.get("tempPassUsed")&&News.App.Adobe.Authentication.isTempPassExpired()&&(Cookies.remove("tempPassUsed"),-1<window.location.pathname.indexOf("watch_spectrum_news_live")&&(News.App.QuantumAnalytics.playbackExitBeforeStartByApp("SpectrumLocal_playbackExitBeforeStart_linear_byApplication",
"VP-1001","Trial Over"),News.App.Pinxt.Authentication.goToPage("unauthorized")),News.App.Adobe.Authentication.logout())},12E4);"1"!==Cookies.get("tempPassUsed")||News.App.Adobe.Authentication.isTempPassExpired()||g('*[class*\x3d"TempPass"]').hide()},setTokenExpiryDate:function(a){a=new Date(a);var b=new Date(a);b=new Date(b.setMinutes(b.getMinutes()+2));void 0===Cookies.get("tokenExpiryDate")&&Cookies.set("tokenExpiryDate",a,{expires:b,path:"/"})},expireMVPD:function(){var a=Cookies.get("tokenExpiryDate");
a=new Date(a);return new Date(a.setMinutes(a.getMinutes()+2))},isTempPassExpired:function(){var a=new Date,b=new Date(Cookies.get("tokenExpiryDate"));return a>=b},setMetadataStatus:function(a){News.App.Adobe.Authentication.hhid=a.householdID;News.App.Adobe.Authentication.hbaStatus=a.hba_status;News.App.Adobe.Authentication.mvpd=a.mvpd;News.App.Pinxt.Authentication.setCookie("player-mvpd",a.mvpd);News.App.Pinxt.Authentication.setCookie("player-hhid",a.householdID);localStorage.setItem("player-mvpd",
a.mvpd);localStorage.setItem("player-hhid",a.householdID);g("#analyticsDataLayer").attr("data-hhid",a.householdID);News.App.Adobe.Authentication.trackLogInSuccess(a)},trackLogInSuccess:function(a){a=new CustomEvent("userInteraction",{detail:{action:"loginSuccess",mvpd:Cookies.get("player-mvpd"),hhid:a.householdID,hba_status:a.hba_status,isAuthenticated:News.App.Adobe.Authentication.getIsAuthenticated()}});window.dispatchEvent(a)},getIsAuthenticated:function(){return Cookies.get("authenticated")?"Yes":
"No"}}})(jQuery);